with recursive
integers(i) as (select 0 union all select i + 1 from integers where i < 101),
iterated_complex_numbers(i, ix, iy, x, y, cx, cy) as (
  select 0, x.i, y.i, -2.0 + 0.03*x.i :: float, -1.5 + 0.03*y.i :: float, 0 :: float, 0 :: float
  from integers as x, integers as y
  union all
  select i + 1, ix, iy, x, y, cx*cx - cy*cy + x, 2*cx*cy + y
  from iterated_complex_numbers
  where i < 27 and cx*cx + cy*cy < 16.0
),
iteration_bounds(i, ix, iy) as (
  select max(i), ix, iy from iterated_complex_numbers
  group by ix, iy order by ix, iy
)
select array_to_string(array_agg(substring(' ------~~~~~~#######++++++ ', i, 1)), '')
from iteration_bounds group by iy order by iy;

/* ref: https://wiki.postgresql.org/wiki/Mandelbrot_set
------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------~~~----------------------------------------
 ------------------------------------------------------------~~~---------------------------------------
 ------------------------------------------------------------~#~~--------------------------------------
 ------------------------------------------------------------~##~~~~-----------------------------------
 ------------------------------------------------------------~~#~~#~~----------------------------------
 -----------------------------------------------------------~~~~##~~-----------------------------------
 -----------------------------------------------------------~~~~ ~~~~----------------------------------
 ---------------------------------------------------------~~~~## #~~~----------------------------------
 ---------------------------------------------------------~~ ~#   ~~~~---------------------------------
 --------------------------------------------------------~####   ++##~---------------------------------
 -------------------------------------------------------~~~~       +#~~--------------------------------
 -------------------------------------------------------~~~#        ~~~--------------------------------
 -----------------------------------------------------~~~~~#        #~~~-------------------------------
 ------------------------------------------------~~~~~~~~~~~        ~~~~~~-----------------------------
 ----------------------------------------------~~~#~~~~~~~~##      #~~~~+~~~--~~~----------------------
 ---------------------------------------------~~ +#~~~~  #  ++    +# ##~+#~~~~~~~----------------------
 ---------------------------------------------~~   +#~#               +  #~~~~~~#~---------------------
 ---------------------------------------------~~#    #                   ##~# ####---------------------
 --------------------------------------------~~~~+                        +#    #~---------------------
 -------------------------------------------~~~~~+                         +   +~~---------------------
 ------------------------------------------~~~~~~#                              ~~---------------------
 -----------------------------------------~~~~ ##                             #~~~---------------------
 ----------------------------------------~~~~                                  ~~~~--------------------
 ------------------------~~~------------~~~~~#                                  ~~~~-------------------
 ------------------------~#~~~~~~~~~~~~~~~~~~#                                  #~~#-------------------
 -----------------------~~#~~~~~~#~~~~~~~~~~                                      #~-------------------
 -----------------------~~#~~#~~~  ~~~~~~~~~#                                     ##-------------------
 -----------------------~~~~  #~~#+ ##~~~~~~                                     #~~-------------------
 -----------------------~~~~#  + +  # ##~~~#                                     #~~-------------------
 ----------------------~~~~#          + #~~                                      +#~-------------------
 ---------------------~~~~~~#            ##                                        ~-------------------
 -------------------~~~~~ #+              #                                      ~~--------------------
 ------------------~~#~~~~#               +                                       ~--------------------
 -----------------~~~ ~~~#                                                       ~~--------------------
 ----------------~~~~~+###                                                       ~---------------------
 -------~~~-~~~~~~~~~~#                                                        #~~---------------------
 ------~~~~~~~~~~~#~#+                                                         ~~~---------------------
                                                                             #~~~----------------------
 ------~~~~~~~~~~~#~#+                                                         ~~~---------------------
 -------~~~-~~~~~~~~~~#                                                        #~~---------------------
 ----------------~~~~~+###                                                       ~---------------------
 -----------------~~~ ~~~#                                                       ~~--------------------
 ------------------~~#~~~~#               +                                       ~--------------------
 -------------------~~~~~ #+              #                                      ~~--------------------
 ---------------------~~~~~~#            ##                                        ~-------------------
 ----------------------~~~~#          + #~~                                      +#~-------------------
 -----------------------~~~~#  + +  # ##~~~#                                     #~~-------------------
 -----------------------~~~~  #~~#+ ##~~~~~~                                     #~~-------------------
 -----------------------~~#~~#~~~  ~~~~~~~~~#                                     ##-------------------
 -----------------------~~#~~~~~~#~~~~~~~~~~                                      #~-------------------
 ------------------------~#~~~~~~~~~~~~~~~~~~#                                  #~~#-------------------
 ------------------------~~~------------~~~~~#                                  ~~~~-------------------
 ----------------------------------------~~~~                                  ~~~~--------------------
 -----------------------------------------~~~~ ##                             #~~~---------------------
 ------------------------------------------~~~~~~#                              ~~---------------------
 -------------------------------------------~~~~~+                         +   +~~---------------------
 --------------------------------------------~~~~+                        +#    #~---------------------
 ---------------------------------------------~~#    #                   ##~# ####---------------------
 ---------------------------------------------~~   +#~#               +  #~~~~~~#~---------------------
 ---------------------------------------------~~ +#~~~~  #  ++    +# ##~+#~~~~~~~----------------------
 ----------------------------------------------~~~#~~~~~~~~##      #~~~~+~~~--~~~----------------------
 ------------------------------------------------~~~~~~~~~~~        ~~~~~~-----------------------------
 -----------------------------------------------------~~~~~#        #~~~-------------------------------
 -------------------------------------------------------~~~#        ~~~--------------------------------
 -------------------------------------------------------~~~~       +#~~--------------------------------
 --------------------------------------------------------~####   ++##~---------------------------------
 ---------------------------------------------------------~~ ~#   ~~~~---------------------------------
 ---------------------------------------------------------~~~~## #~~~----------------------------------
 -----------------------------------------------------------~~~~ ~~~~----------------------------------
 -----------------------------------------------------------~~~~##~~-----------------------------------
 ------------------------------------------------------------~~#~~#~~----------------------------------
 ------------------------------------------------------------~##~~~~-----------------------------------
 ------------------------------------------------------------~#~~--------------------------------------
 ------------------------------------------------------------~~~---------------------------------------
 -----------------------------------------------------------~~~----------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------
 ------------------------------------------------------------------------------------------------------*/
